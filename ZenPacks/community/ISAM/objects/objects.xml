<objects>
<!-- ('', 'zport', 'dmd', 'Events', 'Status', 'ISAMReverseProxy') -->
<object id="/zport/dmd/Events/Status/ISAMReverseProxy" module="Products.ZenEvents.EventClass" class="EventClass">
<property type="text" id="transform" mode="w">
# Count events and adapt severity according to counts ################################

# Count identical events ###################################################
# Initialize existing_count.
existing_count = 0
# Prefix for fingerprint (dedupid).
dedupfields = [evt.device, evt.component, evt.eventClass]
if getattr(evt, 'eventKey', False):
    dedupfields += [evt.eventKey, evt.severity]      # Should always be this one
else:
    dedupfields += [evt.severity, evt.summary]

zep = getFacade('zep')
# Filter for New and Ack'd event with same fingerprint
evt_filter = zep.createEventFilter(status=(0,1), fingerprint='|'.join(map(str, dedupfields)))
summaries = zep.getEventSummaries(0, 1, filter=evt_filter)
if summaries['total']:
    existing_count = list(summaries['events'])[0]['count']

# Look for child events ####################################################
# Filter for New and Ack'd event with severity higher or equal to warn, same device and same Reverse Proxy
evt_filter = zep.createEventFilter(status=(0,1), severity=(3,4,5), element_identifier=(evt.device), details={'isamRP': evt.isamRP})  # Adapt for other classes
summaries = zep.getEventSummaries(0, 10, filter=evt_filter)
for e in summaries['events']:
    if e['occurrence'][0]['event_class'].startswith('/Status/ISAMJunction'):
        # If child event found, set current event severity to Info
        evt.severity = 2
        break
else:
    # No child event found
    if existing_count &lt; 4:      # Must be higher than for Junction
        # Delay the alert, keep it to Info
        evt.severity = 2
    else:
        # Waited for delay, set it to measured severity
        evt.severity = evt.measured_severity
</property>
</object>
<!-- ('', 'zport', 'dmd', 'Mibs', 'mibs', 'ISS-MIB') -->
<object id="/zport/dmd/Mibs/mibs/ISS-MIB" module="Products.ZenModel.MibModule" class="MibModule">
<property id="zendoc" type="string">
This MIB module defines SNMP trap events generated by the ISAM Appliance.
</property>
<property type="string" id="language" mode="w">
SMIv2
</property>
<property type="string" id="contact" mode="w">
IBM customer support: ibm.com/support
</property>
<property type="string" id="description" mode="w">
This MIB module defines SNMP trap events generated by the ISAM Appliance.
</property>
<tomanycont id="nodes">
<object id="common" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
node
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4
</property>
</object>
<object id="iss" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
node
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499
</property>
<property type="string" id="status" mode="w">
current
</property>
</object>
<object id="logEntry" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
row
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1
</property>
<property type="string" id="status" mode="w">
current
</property>
</object>
<object id="logEntryCategory" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The log entry event identifier.
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.3
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The log entry event identifier.
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logEntryData" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The source and priority of the event in format 'name=&lt;source&gt;,priority=&lt;priority&gt;'
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.6
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The source and priority of the event in format 'name=&lt;source&gt;,priority=&lt;priority&gt;'
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logEntryDescription" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The log entry contents.
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.5
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The log entry contents.
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logEntryEventId" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The log entry sequence number.
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.4
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The log entry sequence number.
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logEntrySource" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The ISO 8601 date and time in UTC when the log entry was written.
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.2
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The ISO 8601 date and time in UTC when the log entry was written.
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logEntryTime" module="Products.ZenModel.MibNode" class="MibNode">
<property id="zendoc" type="string">
The TimeTicks when the log entry was written.
</property>
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
column
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1.1.1
</property>
<property type="string" id="status" mode="w">
current
</property>
<property type="string" id="description" mode="w">
The TimeTicks when the log entry was written.
</property>
<property type="string" id="access" mode="w">
readonly
</property>
</object>
<object id="logTable" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
table
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1.1
</property>
<property type="string" id="status" mode="w">
current
</property>
</object>
<object id="logdata" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
node
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1.4.1
</property>
</object>
<object id="products" module="Products.ZenModel.MibNode" class="MibNode">
<property type="string" id="moduleName" mode="w">
ISS-MIB
</property>
<property type="string" id="nodetype" mode="w">
node
</property>
<property type="string" id="oid" mode="w">
1.3.6.1.4.1.2499.1
</property>
</object>
</tomanycont>
</object>
</objects>