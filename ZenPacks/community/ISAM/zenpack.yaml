name: ZenPacks.community.ISAM

zProperties:
  zISAMUsername:
    category: ISAM

  zISAMPassword:
    category: ISAM
    type: password

classes:
  ISAMDevice:
    base: [zenpacklib.Device]
    label: ISAM Device
    properties:
      model:
        type: string
        label: Model

  ISAMReverseProxy:
    base: [zenpacklib.Component]
    label: ISAM Reverse Proxy
    properties:
      status:
        type: string
        label: Status
      started:
        type: string
        label: Started
      enabled:
        type: string
        label: Enabled

  ISAMJunction:
    base: [zenpacklib.Component]
    label: ISAM Junction
    properties:
      rp_name:
        type: string
        label: Reverse Proxy Name

  ISAMInterface:
    base: [zenpacklib.Component]
    label: ISAM Interface
    properties:
      enabled:
        type: string
        label: Enabled
      ipv4:
        type: string
        label: IPv4 address

  ISAMFileSystem:
    base: [zenpacklib.Component]
    label: File System
    properties:
      size:
        label: Size
        renderer: Zenoss.render.bytesString

device_classes:
  /Security/ISAM:
    zProperties:
      zPythonClass: ZenPacks.community.ISAM.ISAMDevice
      zSnmpMonitorIgnore: true
      zCollectorPlugins:
        - zenoss.snmp.NewDeviceMap
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.HRFileSystemMap
        - zenoss.snmp.HRSWRunMap
        - zenoss.snmp.HRSWInstalledMap
        - zenoss.snmp.HSRPMap
        - zenoss.snmp.CpuMap
        - zenoss.snmp.IpServiceMap
        - community.json.ISAM
      zDeviceTemplates:
        - Device
        - ISAMDevice

    templates:
      ISAMDevice:
        targetPythonClass: ZenPacks.community.ISAM.ISAMDevice

        datasources:
          cpu:
            type: Python
            plugin_classname: ZenPacks.community.ISAM.dsplugins.ISAMDevice.ISAMDevice
            cycletime: 60

            datapoints:
              user_cpu: GAUGE
              system_cpu: GAUGE
              idle_cpu: GAUGE

          memory:
            type: Python
            plugin_classname: ZenPacks.community.ISAM.dsplugins.ISAMDevice.ISAMDevice
            cycletime: 60

            datapoints:
              used: GAUGE
              free: GAUGE
              total: GAUGE
              used_perc: GAUGE

        graphs:
          CPU:
            units: percent
            width: 1000

            graphpoints:
              User CPU percentage:
                dpName: cpu_user_cpu
                lineType: AREA
              System CPU percentage:
                dpName: cpu_system_cpu
                lineType: AREA
                stacked: true
              Idle CPU percentage:
                dpName: cpu_idle_cpu
                lineType: AREA
                stacked: true

          Memory:
            units: bytes
            width: 1000
            miny: 0
            base: true

            graphpoints:
              Memory usage (MB):
                dpName: memory_used

          Memory Percentage:
            units: percent
            width: 1000
            miny: 0
            maxy: 100

            graphpoints:
              Memory usage (percentage):
                dpName: memory_used_perc

      ISAMReverseProxy:
        datasources:
          status:
            type: Python
            plugin_classname: ZenPacks.community.ISAM.dsplugins.ISAMReverseProxy.RPStatus
            cycletime: 60

            datapoints:
              status: GAUGE

          throughput:
            type: Python
            plugin_classname: ZenPacks.community.ISAM.dsplugins.ISAMReverseProxy.RPThroughput
            cycletime: 60

            datapoints:
              requests: GAUGE

        graphs:
          Status:
            units: percent
            width: 1000
            miny: 0
            maxy: 2

            graphpoints:
              status:
                dpName: status_status


          Throughput:
            units: requests
            width: 1000
            miny: 0

            graphpoints:
              requests:
                dpName: throughput_requests
                cFunc: LAST

class_relationships:
  - ISAMDevice 1:MC ISAMReverseProxy
  - ISAMDevice 1:MC ISAMInterface
  - ISAMDevice 1:MC ISAMFileSystem
  - ISAMReverseProxy 1:MC ISAMJunction
